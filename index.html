<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>SprintWriter</title>
    <style>
        html, body, div {margin: 0; padding: 0;}
        textarea {border: none; font-size: 18px;}
        textarea.peek {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body></body>
<script src="elm.js"></script>
<script>

var SprintWriter = Elm.fullscreen(Elm.SprintWriter, { charPress : "" });
var inWritingMode = false;

SprintWriter.ports.writingMode.subscribe(function(val) { inWritingMode = val; console.log(val); });

document.addEventListener("keypress", function(e) {
    if(inWritingMode) SprintWriter.ports.charPress.send(String.fromCharCode(e.charCode));
});

document.addEventListener("keydown", function(e) {
    if([8,9,116,117].indexOf(e.keyCode) != -1 && inWritingMode) e.preventDefault();
    if(e.keyCode === 9) SprintWriter.ports.charPress.send("    ");
});

window.onbeforeunload = function(){
    return 'WARNING: Unsaved progress will be lost. Make sure to copy any text you want to keep into another application before leaving or reloading the page!';
};

</script>
</html>
